function isSet(t){return"undefined"!=typeof t&&null!=t}function setCookie(t,e,n){var r=new Date;r.setTime(r.getTime()+24*n*60*60*1e3);var a="expires="+r.toUTCString();document.cookie=t+"="+e+"; "+a}function getCookie(t){for(var e=t+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var a=n[r];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(e))return a.substring(e.length,a.length)}return null}function timestampToDate(t,e){isSet(e)||(e="dateAndTime");var n=new Date(t),r=n.getFullYear(),a=("0"+(n.getMonth()+1)).slice(-2),i=("0"+n.getDate()).slice(-2),o=("0"+n.getHours()).slice(-2),s=("0"+n.getMinutes()).slice(-2);return"dateAndTime"==e?i+"."+a+"."+r+" "+o+":"+s:"time"==e?o+":"+s:void 0}function GetLanguage(){return isSet(language)||(language=isSet(getCookie("Language"))?getCookie("Language"):"ENG"),language}function SetLanguage(t){language=t,setCookie("Language",t,30)}function GetTranslation(t){var e=GetLanguage();return"GER"==e?translations[t][1]:translations[t][0]}function GetPeriod(){return isSet(period)||(period=isSet(getCookie("Period"))?getCookie("Period"):"10"),period}function SetPeriod(t){period=t,setCookie("Period",t,30)}function processBuffer(t,e){for(var n=[],r=[],a=0;a<t.length;a++)n.push(t[a].durationSec/60),r.push(t[a].size+" "+GetTranslation("OBJECTS"));charts.reinit(e+"BarChart"),charts[e+"BarChart"]=new Chart($("#"+e+"-durationOfFrequency"),{type:"bar",data:{datasets:[{data:n,backgroundColor:["#FF6384","#4BC0C0","#FFCE56","#E7E9ED","#36A2EB"],label:"My dataset"}],labels:r},options:{legend:{display:!1}}})}function processConnectionHandler(t,e){$("#"+e+"-lastConnection").text(timestampToDate(t.lastConnection));for(var n=[],r=[],a=0;a<t.packetSizeAttributes.length;a++)n.push(t.packetSizeAttributes[a].freq),r.push(t.packetSizeAttributes[a].size+" "+GetTranslation("OBJECTS"));charts.reinit(e+"PieChart"),charts[e+"PieChart"]=new Chart($("#"+e+"-packetSizeAttributes"),{type:"pie",data:{datasets:[{data:n,backgroundColor:["#FF6384","#4BC0C0","#FFCE56","#E7E9ED","#36A2EB"],label:"My dataset"}],labels:r}}),$("#"+e+"-minConnDuration-time").text(timestampToDate(t.minConnDuration.timestamp)),$("#"+e+"-minConnDuration-duration").text(t.minConnDuration.durationMs+" ms"),$("#"+e+"-avgConnDuration-duration").text(t.avgConnDuration.durationMs+" ms"),$("#"+e+"-maxConnDuration-time").text(timestampToDate(t.maxConnDuration.timestamp)),$("#"+e+"-maxConnDuration-duration").text(t.maxConnDuration.durationMs+" ms");for(var i=[],o=[],a=0;a<t.packetSizeAttributes.length;a++)i.push(t.packetSizeAttributes[a].durationMs),o.push(t.packetSizeAttributes[a].size+" "+GetTranslation("OBJECTS"));charts.reinit(e+"BarChart"),charts[e+"BarChart"]=new Chart($("#"+e+"-avgConnDurations"),{type:"bar",data:{datasets:[{data:i,backgroundColor:["#FF6384","#4BC0C0","#FFCE56","#E7E9ED","#36A2EB"]}],labels:o},options:{legend:{display:!1}}})}function initMetaData(){$.ajax({url:apiUri+"metadata",dataType:"json",type:"GET",success:function(t){$("#metadata-instanceName").text(t.instanceName);var e=[];$.each(t.processUptimeHours,function(t,n){e.push(t.capitalizeFirstLetter()+" "+n+" "+GetTranslation("HOURS"))}),$("#metadata-processUptimeHours").text(e.join(", "))},error:function(t){console.error(t)}})}function initInputConnectionHandler(){$.ajax({url:apiUri+"connHandler/in/"+GetPeriod(),dataType:"json",type:"GET",success:function(t){processConnectionHandler(t,"inputConnHandler")},error:function(t){console.error(t)}})}function initInputBuffer(){$.ajax({url:apiUri+"buffer/in/"+GetPeriod(),dataType:"json",type:"GET",success:function(t){processBuffer(t,"inputBuffer")},error:function(t){console.error(t)}})}function initProcessing(){$.ajax({url:apiUri+"processing/"+GetPeriod(),dataType:"json",type:"GET",success:function(t){for(var e=[],n=[],r=0;r<t.procChainAttributes.length;r++)e.push(t.procChainAttributes[r].freq),n.push(t.procChainAttributes[r].chain);charts.reinit("processingPieChart"),charts.processingPieChart=new Chart($("#processing-procChainAttributes"),{type:"pie",data:{datasets:[{data:e,backgroundColor:["#FF6384","#4BC0C0","#FFCE56","#E7E9ED","#36A2EB"],label:"My dataset"}],labels:n}}),$("#processing-minConnDuration-time").text(timestampToDate(t.minProcDuration.timestamp)),$("#processing-minConnDuration-duration").text(t.minProcDuration.durationMs+" ms"),$("#processing-avgConnDuration-duration").text(t.avgProcDuration.durationMs+" ms"),$("#processing-maxConnDuration-time").text(timestampToDate(t.maxProcDuration.timestamp)),$("#processing-maxConnDuration-duration").text(t.maxProcDuration.durationMs+" ms");for(var a=[],i=[],r=0;r<t.procChainAttributes.length;r++)a.push(t.procChainAttributes[r].durationMs),i.push(t.procChainAttributes[r].chain);charts.reinit("processingBarChart"),charts.processingBarChart=new Chart($("#processing-avgProcDurations"),{type:"bar",data:{datasets:[{data:a,backgroundColor:["#FF6384","#4BC0C0","#FFCE56","#E7E9ED","#36A2EB"]}],labels:i},options:{legend:{display:!1}}})},error:function(t){console.error(t)}})}function initOutputBuffer(){$.ajax({url:apiUri+"buffer/out/"+GetPeriod(),dataType:"json",type:"GET",success:function(t){processBuffer(t,"outputBuffer")},error:function(t){console.error(t)}})}function initOutputConnectionHandler(){$.ajax({url:apiUri+"connHandler/out/"+GetPeriod(),dataType:"json",type:"GET",success:function(t){processConnectionHandler(t,"outputConnHandler")},error:function(t){console.error(t)}})}function initOutErrorHandler(){$.ajax({url:apiUri+"outErrHandler/"+GetPeriod(),dataType:"json",type:"GET",success:function(t){for(var e=[],n=[],r=0;r<t.length;r++)e.push(t[r].freq),n.push(isSet(t[r].handling)?t[r].handling:GetTranslation("NO_ERROR"));charts.reinit("outErrorHandlerPieChart"),charts.outErrorHandlerPieChart=new Chart($("#outErrHandler-pie"),{type:"pie",data:{datasets:[{data:e,backgroundColor:["#FF6384","#4BC0C0","#FFCE56","#E7E9ED","#36A2EB"],label:"My dataset"}],labels:n}});for(var a=[],i=[],r=0;r<t.length;r++)isSet(t[r].durationMs)&&isSet(t[r].handling)&&(a.push(t[r].durationMs),i.push(t[r].handling));charts.reinit("outErrorHandlerBarChart"),charts.outErrorHandlerBarChart=new Chart($("#outErrHandler-bar"),{type:"bar",data:{datasets:[{data:a,backgroundColor:["#FF6384","#4BC0C0","#FFCE56","#E7E9ED","#36A2EB"]}],labels:i},options:{scales:{xAxes:[{display:!1}]}}})},error:function(t){console.error(t)}})}function initThroughput(){$.ajax({url:apiUri+"throughput/"+GetPeriod(),dataType:"json",type:"GET",success:function(t){for(var e=[],n=[],r=0;r<t.length;r++)e.push(t[r].objsPerMin),n.push(timestampToDate(t[r].intervalStart,"time"));charts.reinit("throughputLineChart"),charts.throughputLineChart=new Chart($("#throughput-line"),{type:"line",data:{datasets:[{label:GetTranslation("THROUGHPUT"),fill:!1,lineTension:.1,backgroundColor:"rgba(75,192,192,0.4)",borderColor:"rgba(75,192,192,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:e,spanGaps:!1}],labels:n},options:{legend:{display:!1}}})},error:function(t){console.error(t)}})}String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var translations={APP_TITLE:["Agent Service Monitoring","Vermittler-Service Monitoring"],LANGUAGE:["Language","Sprache"],ENGLISH:["English","Englisch"],GERMAN:["German","Deutsch"],PERIOD_OF_TIME:["Viewed period of time","Betrachteter Zeitraum"],MINUTES:["minutes","Minuten"],HOUR:["hour","Stunde"],HOURS:["hours","Stunden"],SERVICE_INSTANCE:["Service instance","Service-Instanz"],FREQUENCY_OF_PACKET_SIZES:["Frequency of packet sizes","Häufigkeit von Paketgrößen"],OBJECTS:["objects","Objekte"],RUNNING_TIME_OF_PROCESSES:["Running time of processes","Laufzeit der Prozesse"],LAST_CONNECTION:["Last connection","Letzte Verbindung"],DURATION_OF_CONNECTIONS:["Duration of connections","Dauer der Verbindungen"],AVERAGE:["Average","Durchschnittlich"],MAXIMUM:["Maximum","Maximal"],AVERAGE_DURATION_OF_CONNECTIONS:["Average duration of connections","Durchschnittliche Verbindungsdauer"],DURATION_OF_FREQUENCY:["Duration of frequency","Dauer der Größe"],FREQUENCY_OF_PROCESSING_CHAINS:["Frequency of processing chains","Häufigkeit von Processing Chains"],DURATION_OF_PROCESSING:["Duration of processing","Dauer der Verarbeitungen"],AVERAGE_DURATION_OF_PROCESSING:["Average duration of processing","Durchschnittliche Verarbeitungsdauer"],ACTIONS_OF:["Actions of","Aktionen vom"],NO_ERROR:["No error","Kein Fehler"],THROUGHPUT:["Throughput","Durchsatz"]},language;$(document).ready(function(){$("#language-switch").val(GetLanguage()),$(".translate").each(function(){$(this).text(GetTranslation($(this).text()))})}),$("#language-switch").change(function(){SetLanguage($(this).val()),location.reload()});var period;$(document).ready(function(){$("#period-switch").val(GetPeriod())}),$("#period-switch").change(function(){SetPeriod($(this).val()),location.reload()});var R=$("html").data("root"),apiUri=R+"DEMO/",test,charts={reinit:function(t){isSet(this[t])&&this[t].destroy()}};$(document).ready(function(){initMetaData(),setInterval(initMetaData,21e5),initInputConnectionHandler(),setInterval(initInputConnectionHandler,20500),initInputBuffer(),setInterval(initInputBuffer,21e3),initProcessing(),setInterval(initProcessing,21500),initOutputBuffer(),setInterval(initOutputBuffer,22e3),initOutputConnectionHandler(),setInterval(initOutputConnectionHandler,22500),initOutErrorHandler(),setInterval(initOutErrorHandler,23e3),initThroughput(),setInterval(initThroughput,23500)});